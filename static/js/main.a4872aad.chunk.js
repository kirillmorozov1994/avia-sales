(this.webpackJsonpaviasales=this.webpackJsonpaviasales||[]).push([[0],{11:function(e,t,r){"use strict";var s=r(1),n=r.n(s),a=function(){return n.a.createElement("div",{className:"spinner-wrap"},n.a.createElement("div",{className:"spinner"},n.a.createElement("div",{className:"dot1"}),n.a.createElement("div",{className:"dot2"})))};t.a=a},14:function(e,t,r){e.exports=r(23)},22:function(e,t,r){},23:function(e,t,r){"use strict";r.r(t);var s=r(1),n=r.n(s),a=r(6),i=r.n(a),c=r(8),o=r(3),l=r.n(o),u=r(4),f=r(7),h=r(12),k=r(13),p=r(0),d=(r(21),[{field:"\u0412\u0441\u0435",label:"all",check:!0},{field:"\u0411\u0435\u0437 \u0431\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a",label:"noStop",check:!0,stop:0},{field:"1 \u0431\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430",label:"oneStop",check:!0,stop:1},{field:"2 \u0431\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",label:"twoStop",check:!0,stop:2},{field:"3 \u0431\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",label:"threeStop",check:!0,stop:3}]),g=!0,b=!0,T=null,v=null,m=null,C=null,O=5,j=1,w=r(5),x=function(e,t){var r=e.every((function(e){var t=e.label,r=e.check;return"all"===t||r}));return!t&&r?e.map((function(e){return Object(w.a)(Object(w.a)({},e),{},{check:r})})):t&&!r?e.map((function(e){return"all"===e.label?Object(w.a)(Object(w.a)({},e),{},{check:r}):e})):e},E=function(e,t){return"price"===t?function(e){return e.slice().sort((function(e,t){return e.price-t.price}))}(e):"duration"===t?function(e){return e.slice().sort((function(e,t){return e.segments[0].duration+e.segments[1].duration-t.segments[0].duration-t.segments[1].duration}))}(e):void 0};Object(p.h)({enforceActions:"observed"});var S=function(){function e(){var t=this;Object(h.a)(this,e),this.filterTransfer=d,this.loading=b,this.error=T,this.searchId=v,this.tickets=m,this.isFastOrCheap=g,this.perPage=O,this.page=j,this.totalTickets=C,this.setChangeFilterTransfer=function(e){if("all"===e){var r=!t.filterTransfer.find((function(t){return t.label===e})).check;t.filterTransfer.forEach((function(e){e.check=r}))}else t.filterTransfer.forEach((function(t){t.label===e&&(t.check=!t.check)}));t.setSelectedFilterTransfer()},this.setChangeFilterPrice=function(){t.isFastOrCheap=!t.isFastOrCheap},this.setSearchId=function(e){t.searchId=e},this.setTickets=function(e){t.tickets&&0!==t.tickets.length?t.tickets=[].concat(Object(f.a)(t.tickets),Object(f.a)(e)):t.tickets=e},this.setClearState=function(){t.tickets=[]},this.setChangeLoading=function(e){t.loading=e},this.setChangeError=function(e){t.error=e},this.setTotalTickets=function(e){t.totalTickets=e},this.setPage=function(){t.page=t.page+1},this.request=function(){var e=Object(u.a)(l.a.mark((function e(r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.setChangeLoading(!0),t.setChangeError(null),!r){e.next=7;break}return t.setClearState(),e.next=7,t.requestSearchId();case 7:return e.next=9,t.requestTickets();case 9:t.setChangeLoading(!1),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),t.setChangeLoading(!1),t.setChangeError(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),this.requestSearchId=Object(u.a)(l.a.mark((function e(){var r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://front-test.beta.aviasales.ru/search");case 2:if(200===(r=e.sent).status){e.next=5;break}throw new Error(r.status);case 5:return e.next=7,r.json();case 7:s=e.sent,t.setSearchId(s.searchId);case 9:case"end":return e.stop()}}),e)}))),this.requestTickets=Object(u.a)(l.a.mark((function e(){var r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://front-test.beta.aviasales.ru/tickets?searchId=".concat(t.searchId));case 2:if(200===(r=e.sent).status){e.next=5;break}throw new Error(r.status);case 5:return e.next=7,r.json();case 7:s=e.sent,t.setTickets(s.tickets),t.setTotalTickets(s.tickets.length);case 10:case"end":return e.stop()}}),e)}))),this.requestInitialData=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.request(!0);case 1:case"end":return e.stop()}}),e)}))),this.requestNextData=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.request(!1);case 1:case"end":return e.stop()}}),e)})))}return Object(k.a)(e,[{key:"setSelectedFilterTransfer",value:function(){var e=this.filterTransfer[0].check;e||(this.filterTransfer=x(this.filterTransfer,e)),e&&(this.filterTransfer=x(this.filterTransfer,e))}},{key:"filtersTickets",get:function(){if(this.tickets){var e=this.isFastOrCheap?"price":"duration";if(this.filterTransfer[0].check)return E(this.tickets,e);var t=this.filterTransfer.filter((function(e){var t=e.label,r=e.check;return"all"!==t&&r})).map((function(e){return e.stop})),r=this.tickets.filter((function(e){var r=e.segments;return t.includes(r[0].stops.length)&&t.includes(r[1].stops.length)}));return E(r,e)}return this.tickets}},{key:"visibleTickets",get:function(){return this.filtersTickets?this.filtersTickets.slice(0,this.perPage*this.page):this.filtersTickets}},{key:"hasMore",get:function(){return!!this.totalTickets&&this.totalTickets>this.perPage*this.page}}]),e}(),I=new(S=Object(p.j)(S,{filterTransfer:p.o,loading:p.o,error:p.o,searchId:p.o,tickets:p.o,isFastOrCheap:p.o,totalTickets:p.o,page:p.o,filtersTickets:p.g,visibleTickets:p.g,hasMore:p.g,setPage:p.f,setChangeFilterTransfer:p.f,setSelectedFilterTransfer:p.f,setChangeFilterPrice:p.f,setTotalTickets:p.f.bound,setSearchId:p.f.bound,setTickets:p.f.bound,setChangeLoading:p.f.bound,setChangeError:p.f.bound,setClearState:p.f.bound})),F=r(11),q=(r(22),Object(s.lazy)((function(){return Promise.all([r.e(3),r.e(4)]).then(r.bind(null,29))})));i.a.render(n.a.createElement(c.a,{store:I},n.a.createElement(s.Suspense,{fallback:n.a.createElement(F.a,null)},n.a.createElement(q,null))),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.a4872aad.chunk.js.map